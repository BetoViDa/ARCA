{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = __importStar(require(\"react\"));\n\nvar UnityLoaderService_1 = __importDefault(require(\"../services/UnityLoaderService\"));\n\nrequire(\"../declarations/UnityLoader\");\n\nrequire(\"../declarations/UnityInstance\");\n\nrequire(\"../declarations/ReactUnityWebgl\");\n\nvar Unity =\n/** @class */\nfunction (_super) {\n  __extends(Unity, _super);\n  /**\n   * Initialized the component.\n   * @param {IUnityProps} props\n   */\n\n\n  function Unity(props) {\n    var _this = _super.call(this, props) || this;\n    /**\n     * The component state.\n     * @type {IUnityState}\n     * @public\n     */\n\n\n    _this.state = {};\n    _this.unityLoaderService = new UnityLoaderService_1.default();\n    _this.onWindowResizeBinding = _this.onWindowResize.bind(_this);\n    _this.unityContent = _this.props.unityContent;\n\n    _this.unityContent.setComponentInstance(_this);\n\n    return _this;\n  }\n  /**\n   * An event that is triggered by the Unity player. This tracks\n   * the loading progression of the player. It will send '1' when\n   * the loading is completed.\n   * @param {UnityInstance} unityInstance\n   * @param {number} progression\n   * @private\n   */\n\n\n  Unity.prototype.onProgress = function (unityInstance, progression) {\n    this.unityContent.triggerUnityEvent(\"progress\", progression);\n    if (progression === 1) this.unityContent.triggerUnityEvent(\"loaded\");\n  };\n  /**\n   * When the window is resized.\n   */\n\n\n  Unity.prototype.onWindowResize = function () {\n    if (this.unityContent.unityConfig.adjustOnWindowResize === true) {\n      this.unityContent.triggerUnityEvent(\"resized\");\n      this.adjustCanvasToContainer();\n    }\n  };\n  /**\n   * Since the Unity canvas itself does not respond to the resizing\n   * of it's container we have to manually do this. A width and height\n   * of 100% does not seem to work, so we have to fetch it's parent's\n   * size to adject the canvas.\n   * @private\n   */\n\n\n  Unity.prototype.adjustCanvasToContainer = function () {\n    if (typeof this.htmlElement !== \"undefined\") {\n      var _width = this.htmlElement.offsetWidth;\n      var _height = this.htmlElement.offsetHeight;\n      var _canvas = this.htmlElement.getElementsByTagName(\"canvas\")[0];\n      if (typeof _canvas !== \"undefined\" && _canvas.height !== _height) _canvas.height = _height;\n      if (typeof _canvas !== \"undefined\" && _canvas.width !== _width) _canvas.width = _width;\n    }\n  };\n  /**\n   * Initialzied the Unity player when the component is mounted.\n   * @public\n   */\n\n\n  Unity.prototype.componentDidMount = function () {\n    var _this = this;\n\n    window.addEventListener(\"resize\", this.onWindowResizeBinding); // prettier-ignore\n\n    this.unityLoaderService.append(this.props.unityContent.unityLoaderJsPath, function () {\n      UnityLoader.Error.handler = function (_message) {\n        _this.unityContent.triggerUnityEvent(\"error\", _message);\n\n        console.error(\"React Unity WebGL\", _message);\n      };\n\n      _this.unityContent.setUnityInstance(UnityLoader.instantiate(\"__ReactUnityWebGL_\" + _this.props.unityContent.uniqueID + \"__\", _this.props.unityContent.buildJsonPath, {\n        onProgress: _this.onProgress.bind(_this),\n        Module: _this.props.unityContent.unityConfig.modules,\n        streamingAssetsUrl: _this.props.unityContent.unityConfig.streamingAssetsUrl,\n        width: \"100%\",\n        height: \"100%\"\n      }));\n    });\n  };\n  /**\n   * Will remove event listeners and clean up systems when the\n   * component is about to unmount.\n   * @public\n   */\n\n\n  Unity.prototype.componentWillUnmount = function () {\n    this.unityContent.remove();\n    window.removeEventListener(\"resize\", this.onWindowResizeBinding);\n  };\n  /**\n   * Renders the unity wrapper and player.\n   * @returns {React.ReactNode} element\n   * @public\n   */\n\n\n  Unity.prototype.render = function () {\n    var _this = this;\n\n    return React.createElement(\"div\", {\n      className: this.props.className || \"\",\n      ref: function (ref) {\n        return _this.htmlElement = ref;\n      },\n      id: \"__ReactUnityWebGL_\" + this.props.unityContent.uniqueID + \"__\",\n      style: {\n        width: this.props.width || \"800px\",\n        height: this.props.height || \"600px\"\n      }\n    });\n  };\n\n  return Unity;\n}(React.Component);\n\nexports.default = Unity;","map":{"version":3,"mappings":"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","names":["require","__extends","props","_super","_this","unityLoaderService","UnityLoaderService_1","onWindowResizeBinding","onWindowResize","bind","unityContent","setComponentInstance","Unity","unityInstance","progression","triggerUnityEvent","unityConfig","adjustOnWindowResize","adjustCanvasToContainer","htmlElement","_width","offsetWidth","_height","offsetHeight","_canvas","getElementsByTagName","height","width","window","addEventListener","append","unityLoaderJsPath","UnityLoader","Error","handler","_message","console","error","setUnityInstance","instantiate","uniqueID","buildJsonPath","onProgress","Module","modules","streamingAssetsUrl","remove","removeEventListener","React","createElement","className","ref","id","style","Component"],"sources":["../../source/components/Unity.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}